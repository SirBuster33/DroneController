#include <Arduino.h>
#include <tuple>  // Allows to easily return multiple values
                  // Source: https://stackoverflow.com/questions/321068/returning-multiple-values-from-a-c-function

// #include <LiquidCrystal_I2C.h>

Class ControllerXY_Button{

const int ControllerXPin = 33;
const int ControllerYPin = 32;
const int ButtonPin = 35;

void setup() {
  pinMode (ControllerXPin, INPUT);
  pinMode (ControllerYPin, INPUT);
  pinMode (ButtonPin, INPUT_PULLUP);

  Serial.begin(9600);
}

std::tuple<int, int> checkDeadZone(int ControllerXValue, int ControllerYValue){
  
  int UpperRange = 40;
  int LowerRange = -40;
  boolean xIsHigh (ControllerXValue > UpperRange);
  boolean xIsLow (ControllerXValue < LowerRange);
  boolean yIsHigh (ControllerYValue > UpperRange);
  boolean yIsLow (ControllerYValue < LowerRange);

  
  if (xIsHigh) {
    ControllerXValue = map(ControllerXValue, UpperRange, 100, 0, 100);
  }
  else if (xIsLow) {
    ControllerXValue = map(ControllerXValue, LowerRange, -100, 0, -100);
  }
  else {
    ControllerXValue = 0;
  }

  if (yIsHigh) {
      ControllerYValue = map(ControllerYValue, UpperRange, 100, 0, 100);    
  }
  else if (yIsLow) {
          ControllerYValue = map(ControllerYValue, LowerRange, -100, 0, -100);
  }
  else {
    ControllerYValue = 0;
  }
  
  return std::make_tuple(ControllerXValue, ControllerYValue);
}

void printButtonState(int ControllerXValue, int ControllerYValue, int ButtonPressed){
  Serial.print("The X-Value is: ");
  Serial.println(ControllerXValue);
  Serial.print("The Y-Value is: ");
  Serial.println(ControllerYValue);

  Serial.print("Button is: ");
  Serial.println(ButtonPressed);

  if (ButtonPressed == 0){
    Serial.println("BANG! You hit the button!");
  }
  else{
    Serial.println("Button is not pressed.");
  }
}

void printSpace(){
  Serial.println("");
  Serial.println("");
  Serial.println("Taking new measurement...");
  Serial.println("");
}

// Loop must be at the bottom for the code to compile without errors.
void loop() {

  int ControllerXValue = map(analogRead(ControllerXPin), 0, 4095, -100, 100);
  int ControllerYValue = map(analogRead(ControllerYPin), 0, 4095, -100, 100);
  int ButtonPressed = digitalRead(ButtonPin);
  
  checkDeadZone(ControllerXValue, ControllerYValue);

  printButtonState(ControllerXValue, ControllerYValue, ButtonPressed);

  printSpace();  
  delay(2000);

}


